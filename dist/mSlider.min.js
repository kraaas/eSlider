"use strict";!function(t,i){var e=i();e.VERSION="0.0.1","function"==typeof require&&"object"==typeof module&&module&&"object"==typeof exports&&exports?module.exports=e:"function"==typeof define&&define.amd?define(function(){return e}):t.mSlider=e}(window,function(){function t(t){if(i.extend(this,{el:"",data:[],initSlide:0,autoPlay:!0,loop:!0,duration:3e3,touchRange:14,transtionType:"normal",transtionTimeFn:"ease-out",transtionTime:300,showIndicator:!0,indicatorPos:"center",indicatorType:"normal",vertical:!1,enableGPU:!0,replace:!1},t),this.el=i.query(this.el),!this.el||1!=this.el.nodeType)throw new TypeError("el should be a selector(String) or an Element!");this.width=this.width?this.width:this.el.offsetWidth,this.height=this.height?this.height:this.el.offsetHeight,this._axis=this.vertical?"Y":"X",this._slides=[],this._transtionFn=e[this.transtionType],this._nextIndex=0,this._offset={},this._indexCache={},this._prefixCls="mslider",this._itemPrefixCls="mslider_item",this._indicatorPrefixCls="mslider_indicator",this._init()}var i={query:function(t){return t&&1!==t.nodetype&&(t=document.querySelector(t)),t},createEl:function(t){return document.createElement(t)},isObject:function(t){return"[object Object]"===Object.prototype.toString.call(t)},extend:function(){return Object.assign||function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");t=Object(t);for(var i=1;i<arguments.length;i++){var e=arguments[i];if(null!=e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}return t}}()},e={normal:function(t,i,e,n,s,r,a){t.style.transition="none",t.style.zIndex=0,i.style.zIndex=1,this._setCSSTranslate(i,s,r-a),n.style.zIndex=1,this._setCSSTranslate(n,s,r+a),this._setCSSTranslate(e,s,r),e.style.zIndex=2},fade:function(t,i,e,n,s,r,a){var h=Math.abs(r)/a;n=r>=0?i:n,t.style.zIndex=0,t.style.opacity=0,n.style.zIndex=1,n.style.opacity=h,e.style.zIndex=2,e.style.opacity=1-h}},n={NODE:"node",IMG:"img"};return t.transtionFns=e,t.prototype={constructor:t,_init:function(){this._initData(),this._render(),this._bindEvent(),this.currentIndex=this._getCorrectIndex(this.initSlide),this._initSlideStyle(),this._setCSSTransition(),this.slideTo(this.currentIndex),this.autoPlay&&this._autoPlayAction()},_initData:function(){this.data.forEach(function(t,e,s){var r={type:"",name:"",content:"",description:""};"string"==typeof t?(r.content=t,r.name=e):i.isObject(t)&&(r.content=t.content,r.name=t.name||e,r.description=t.description),r.type="<"==r.content[0]?n.NODE:n.IMG,s[e]=r})},_render:function(){function t(){var t=i.createEl("ul");t.classList.add(this._prefixCls+"_slides"),this.data.forEach(function(e,s){var r=i.createEl("li"),a=i.createEl("img");if(r.classList.add(this._itemPrefixCls),e.type==n.IMG?(a.classList.add(this._prefixCls+"_img"),a.src=e.content,r.appendChild(a)):e.type==n.NODE&&(r.innerHTML=e.content),e.description){var h=i.createEl("div");h.classList.add(this._prefixCls+"_description"),h.textContent=e.description,e.type==n.NODE?r.firstChild.appendChild(h):r.appendChild(h)}t.appendChild(r),this._slides.push(r)}.bind(this)),s.appendChild(t)}function e(){var t="normal"==this.indicatorType,e=this.indicatorWrap=i.createEl(t?"ul":"div");if(e.classList.add(this._indicatorPrefixCls,this._indicatorPrefixCls+"--"+this.indicatorPos,this._indicatorPrefixCls+"--"+this.indicatorType),t){this.dots=[];var n=this.normalPrefixCls=this._prefixCls+"_dot";this.data.forEach(function(t,s){var r=i.createEl("li");r.classList.add(n),s==this.currentIndex&&r.classList.add(n+"--active"),e.appendChild(r),this.dots.push(r)}.bind(this))}else{var r=this.circleCurrent=i.createEl("span");r.classList.add(this._prefixCls+"_circle-current");var a=this.circleTotal=i.createEl("span");a.textContent="/"+this.data.length,e.appendChild(r),e.appendChild(a)}s.appendChild(e)}var s=this.wrap=i.createEl("div");s.classList.add(this._prefixCls),s.style.cssText+=";width:"+this.width+";height:"+this.height,t.call(this),this.showIndicator&&e.call(this),this.replace?this.el.parentNode.replaceChild(s,this.el):this.el.appendChild(s)},_bindEvent:function(){this.envents=["touchstart","touchmove","touchend","touchcancel"],this._eventHandler=this._eventHandler.bind(this),this.envents.forEach(function(t){this.wrap.addEventListener(t,this._eventHandler)}.bind(this)),this.resizeEvent="onorientationchange"in window?"orientationchange":"resize",window.addEventListener(this.resizeEvent,this._eventHandler)},_eventHandler:function(t){switch(t.preventDefault(),t.type){case"touchstart":this._startHandler(t);break;case"touchmove":this._moveHandler(t);break;case"touchend":case"touchcancel":this._endHandler(t);break;case this.resizeEvent:this._resizeHandler(t)}},_startHandler:function(t){this._offset={},this.pause(),this.startX=t.targetTouches[0].pageX,this.startY=t.targetTouches[0].pageY,this.startTime=(new Date).getTime()},_moveHandler:function(t){function i(){return 0==this.currentIndex&&0==n}function e(){return this.currentIndex==n}var n,s={},r=t.targetTouches[0];s.X=r.pageX-this.startX,s.Y=r.pageY-this.startY,this._offset=s;var a=s[this._axis]>0?-1:1;n=this._getNextIndex(this.currentIndex+a),(!i.call(this)&&!e.call(this)||this.loop)&&this._transition(this._offset[this._axis])},_endHandler:function(t){var i,e=(new Date).getTime(),n=e-this.startTime>300?this.wh/2:this.touchRange,s=this._offset[this._axis];i=s>=n?-1:s<-n?1:0,this.slideTo(this.currentIndex+i),(!s||Math.abs(s)<this.touchRange)&&this._triggerLink(t&&t.target)},_resizeHandler:function(t){this._setWh(),this._initSlideStyle()},_triggerLink:function(t){console.log(t);var i=t.tagName;if("A"==i)"_blank"==t.getAttribute("target")?window.open(t.href):window.location.href=t.href;else{if("LI"==i&&t.classList.contains(this._itemPrefixCls))return;if(t.classList.contains(this._indicatorPrefixCls))return;this._triggerLink(t.parentNode)}},_transition:function(t){var i,e,n=(this._slides.length-1,this._indexCache[this.currentIndex]);n?(i=n.prevIndex,e=n.nextIndex):(i=this._getNextIndex(this.currentIndex-1),e=this._getNextIndex(this.currentIndex+1),this._indexCache[this.currentIndex]={prevIndex:i,nextIndex:e}),this._slides.forEach(function(n,s){this._transtionFn.call(this,n,this._slides[i],this._slides[this.currentIndex],this._slides[e],this._axis,t,this.wh)}.bind(this))},_getNextIndex:function(t){var i=this._slides.length-1;return t=this.loop?t>i?0:t<0?i:t:t>=i?i:t<0?0:t},_getCorrectIndex:function(t){var i=0,e=!1,n=typeof t;return"number"==n?i=this.initSlide:"string"==n&&(this.data.forEach(function(n,s){n.name==t&&(i=s,e=!0)}.bind(this)),e||console.error("can't find the slide with the name: \""+this.initSlide+'"')),i},_initSlideStyle:function(){var t;this._setWh(),"normal"==this.transtionType&&this._slides.forEach(function(i,e){t=e===this.currentIndex?0:(e-this.currentIndex)*this.wh,this._setCSSTranslate(i,this._axis,t)}.bind(this))},_setWh:function(){this.wh=this.vertical?this.wrap.offsetHeight:this.wrap.offsetWidth},_setCSSTranslate:function(t,i,e){var n=0,s=0;"X"==i?n=e:s=e,this.enableGPU?t.style.cssText+=";-webkit-transform: translate3d("+n+"px, "+s+"px, 0)":t.style.cssText+=";-webkit-transform: translate"+i+"("+e+"px)"},_setCSSTransition:function(){this._slides.forEach(function(t,i){t.style.transition="all "+this.transtionTime+"ms "+this.transtionTimeFn}.bind(this))},_switchIndicator:function(t){"normal"==this.indicatorType?(this.dots[this.currentIndex].classList.remove(this.normalPrefixCls+"--active"),this.dots[this._nextIndex].classList.add(this.normalPrefixCls+"--active")):this.circleCurrent.textContent=t+1},_autoPlayAction:function(){this.pause(),this.autoPlayTimer=window.setTimeout(function(){this.slideTo(this.currentIndex+1),this._autoPlayAction()}.bind(this),this.duration)},slideTo:function(t){"string"==typeof t&&(t=this._getCorrectIndex(t)),this.autoPlay&&this.pause(),this._nextIndex=this._getNextIndex(t),this.showIndicator&&this._switchIndicator(this._nextIndex),this.currentIndex=this._nextIndex,this._transition(0),this.autoPlay&&this._autoPlayAction(),this._setCSSTransition()},slidePrev:function(){this.slideTo(this.currentIndex-1)},slideNext:function(){this.slideTo(this.currentIndex+1)},pause:function(){window.clearTimeout(this.autoPlayTimer)},destroy:function(){this.envents.forEach(function(t){this.wrap.removeEventListener(t,this._eventHandler)}.bind(this)),window.removeEventListener(this.resizeEvent,this._eventHandler),this.wrap.innerHTML=""}},t});